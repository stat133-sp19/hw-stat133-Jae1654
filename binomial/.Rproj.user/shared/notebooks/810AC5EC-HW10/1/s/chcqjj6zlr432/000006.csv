"0",""
"0","tox <- read.table(file = ""tox.txt"",header = TRUE)"
"0",""
"0","before <- tox$base"
"0",""
"0","after <- tox$month15"
"0",""
"0",""
"0","#Since this data is paired, it's better to use paired t test for the parametric test and signed rank sum test for non-parametric test"
"0",""
"0","#Parametric paired t test"
"0","dif <- before-after"
"0",""
"0","n <- length(dif)"
"0",""
"0","se <- sqrt(var(dif)/n)"
"0",""
"0","ts <- mean(dif)/se"
"0",""
"0","p_val <- 2*(1-pt(ts,df = n-1))"
"0","p_val"
"1","[1]"
"1"," 4.167438e-06"
"1","
"
"0","#Use function"
"0","t.test(before,after,paired = TRUE)"
"1","
"
"1","	Paired t-test"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","before and after"
"1",""
"1","
"
"1","t = 6.1549, df = 21, p-value = 4.167e-06"
"1","
"
"1","alternative hypothesis: "
"1","true "
"1",""
"1","difference in means"
"1",""
"1"," is "
"1",""
"1","not equal to"
"1",""
"1"," "
"1",""
"1","0"
"1",""
"1","
"
"1","95"
"1",""
"1"," percent confidence interval:
"
"1",""
"1"," "
"1",""
"1","18.94725 38.28457"
"1",""
"1","
"
"1","sample estimates:
"
"1","mean of the differences "
"1","
"
"1","               28.61591 "
"1","
"
"1","
"
"0","#Reject the null. The treatment is toxic"
"0",""
"0",""
"0","#Signed rank sum test, first manually, but result is different"
"0",""
"0","df <- data.frame(before,after,dif)"
"0",""
"0","df <- mutate(df,rank = rank(dif))"
"0",""
"0","df <- mutate(df, signed_rank = rank*(dif/abs(dif)))"
"0",""
"0","w_plus <- sum(df[df$signed_rank>0,""signed_rank""])"
"0",""
"0","wilcox.test(before, after, paired = TRUE)"
"1","
"
"1","	Wilcoxon signed rank test"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","before and after"
"1",""
"1","
"
"1","V = 246, p-value = 9.06e-06"
"1","
"
"1","alternative hypothesis: "
"1","true "
"1",""
"1","location shift"
"1",""
"1"," is "
"1",""
"1","not equal to"
"1",""
"1"," "
"1",""
"1","0"
"1",""
"1","
"
"1","
"
"0","#Reject the null. so the treatment is toxic."
